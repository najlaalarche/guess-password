<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Guess The Password ‚Äì Speed (20 Questions)</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:0;background:#0b1220;color:#e8eefc}
  .wrap{max-width:900px;margin:auto;padding:18px}
  .card{background:#121c33;border:1px solid #223154;border-radius:16px;padding:16px;margin:12px 0}
  .h1{font-size:22px;font-weight:900}
  .h2{font-size:16px;font-weight:800}
  .muted{opacity:.8}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  input{flex:1;padding:12px;border-radius:12px;border:1px solid #2a3b66;background:#0b1220;color:#e8eefc;font-size:16px}
  button{padding:12px 14px;border-radius:12px;border:0;background:#2b6cff;color:white;font-weight:800;font-size:16px;cursor:pointer}
  button:disabled{opacity:.55;cursor:not-allowed}
  .badge{padding:6px 10px;border-radius:999px;border:1px solid #2a3b66;background:#0b1220;font-size:13px;display:inline-block}
  .bad{background:#2a1111;border-color:#b13a3a}
  .ok{background:#0c2a16;border-color:#1f7a43}
  .warn{background:#2a250f;border-color:#caa43a}
  .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
  .progress{height:10px;border-radius:999px;background:#0b1220;border:1px solid #2a3b66;overflow:hidden}
  .bar{height:100%;width:0%;background:#2b6cff}
  .bigwin{font-size:30px;font-weight:900}
  pre{white-space:pre-wrap;line-height:1.35;margin:0}
  .small{font-size:12px;opacity:.75}
</style>
</head>

<body>
<div class="wrap">

  <div class="card">
    <div class="h1">üîê Guess The Password ‚Äì Speed Challenge</div>
    <div class="muted">Essais illimit√©s ‚Ä¢ Indice apr√®s 40s ‚Ä¢ Passage auto apr√®s 60s ‚Ä¢ Validation au stand</div>
    <div class="row" style="margin-top:10px">
      <span class="badge" id="qBadge">Question 1/20</span>
      <span class="badge" id="timerBadge">‚è≥ 01:00</span>
      <span class="badge mono">FORMAT: mot_minuscule_nombre!</span>
    </div>
    <div class="small" style="margin-top:8px">
      Rappel format: <span class="mono">mot</span> (sans espaces, minuscule) + "_" + <span class="mono">nombre</span> + "!"
    </div>
  </div>

  <div class="card" id="gameCard">
    <div class="h2">üìÑ Dossier / Devinette</div>
    <pre id="prompt"></pre>

    <div style="margin-top:10px" class="progress"><div class="bar" id="bar"></div></div>

    <div class="row" style="margin-top:10px">
      <input id="pw" placeholder="ex: mama_2001!" autocomplete="off"/>
      <button id="btn">TESTER</button>
      <button id="skipBtn" style="background:#44506b">PASSER</button>
    </div>

    <div id="msg" class="badge muted" style="margin-top:10px">Essais illimit√©s. Essaie des combinaisons probables.</div>
    <div id="hintBox" class="badge warn" style="display:none;margin-top:10px">
      üí° Indice : <span id="hintText"></span>
    </div>
  </div>

  <div class="card" id="winCard" style="display:none">
    <div class="bigwin">‚úÖ ACCESS GRANTED</div>
    <div class="muted" style="margin-top:6px">Va vite au stand et montre ce code :</div>
    <div class="badge ok mono" id="winCode" style="margin-top:10px"></div>
  </div>

</div>

<script>
  // =========================
  // TIMING (TES DEMANDES)
  // =========================
  const HINT_AFTER_MS = 40_000;  // 40 secondes
  const AUTO_SKIP_MS  = 60_000;  // 1 minute

  // =========================
  // QUESTIONS (20) ‚Äì bios + devinettes (plus fun/realiste)
  // FORMAT: mot_minuscule_nombre!
  // =========================
  const QUESTIONS = [
    { prompt:
`Q1 ‚Äî SIMO (profil)
Simo est n√© en 2001.
Il est tr√®s proche de sa m√®re, qu‚Äôil appelle ‚Äúmama‚Äù.
Il met souvent une info affective + son ann√©e.

Mot de passe probable ?`,
      hint:`Mot = mama, nombre = 2001`,
      answer:`mama_2001!`
    },
    { prompt:
`Q2 ‚Äî AYA (bio)
Aya adore la photographie.
Sa premi√®re cam√©ra: Canon.
Son chiffre f√©tiche: 7.

Mot de passe probable ?`,
      hint:`objet + chiffre`,
      answer:`canon_7!`
    },
    { prompt:
`Q3 ‚Äî Devinette
Je suis toujours devant toi,
mais tu ne peux jamais me rattraper.

Mot = r√©ponse, Nombre = lettres`,
      hint:`concept du temps`,
      answer:`avenir_6!`
    },
    { prompt:
`Q4 ‚Äî YOUSSEF (football)
Youssef est fan de Messi.
Il ajoute le num√©ro du joueur.

Mot = joueur, Nombre = num√©ro`,
      hint:`Messi = 10`,
      answer:`messi_10!`
    },
    { prompt:
`Q5 ‚Äî Devinette
Je parle sans bouche,
et j‚Äôentends sans oreilles.

Mot = r√©ponse, Nombre = lettres`,
      hint:`ph√©nom√®ne sonore`,
      answer:`echo_4!`
    },
    { prompt:
`Q6 ‚Äî SARA (simple)
Sara utilise son pr√©nom + son √¢ge (22).

Mot = sara, Nombre = 22`,
      hint:`pr√©nom + √¢ge`,
      answer:`sara_22!`
    },
    { prompt:
`Q7 ‚Äî Bio (famille)
Hicham appelle son p√®re ‚Äúbaba‚Äù.
Il met souvent ce mot + son jour de naissance: 15.

Mot de passe probable ?`,
      hint:`mot affectif + 15`,
      answer:`baba_15!`
    },
    { prompt:
`Q8 ‚Äî Devinette
Plus tu en prends,
plus tu en laisses derri√®re toi.

Mot = r√©ponse, Nombre = lettres`,
      hint:`sur le sol`,
      answer:`pas_3!`
    },
    { prompt:
`Q9 ‚Äî HAMZA (gamer)
Pseudo: DarkWolf
Il garde ‚Äúwolf‚Äù.
Nombre = lettres du mot.

Mot de passe ?`,
      hint:`wolf = 4 lettres`,
      answer:`wolf_4!`
    },
    { prompt:
`Q10 ‚Äî Devinette
Je monte mais je ne descends jamais.

Mot = r√©ponse, Nombre = lettres`,
      hint:`li√© au temps`,
      answer:`age_3!`
    },
    { prompt:
`Q11 ‚Äî IMANE (couleur)
Imane met sa couleur favorite dans tout: bleu.
Nombre = lettres.

Mot de passe probable ?`,
      hint:`bleu = 4`,
      answer:`bleu_4!`
    },
    { prompt:
`Q12 ‚Äî Bio (animal)
Lina a un chat qui s‚Äôappelle Luna.
√Çge du chat: 3.

Mot = luna, Nombre = 3`,
      hint:`nom du chat + √¢ge`,
      answer:`luna_3!`
    },
    { prompt:
`Q13 ‚Äî Devinette
Je suis l√©ger comme une plume,
mais personne ne peut me tenir longtemps.

Mot = r√©ponse, Nombre = lettres`,
      hint:`respiration`,
      answer:`souffle_7!`
    },
    { prompt:
`Q14 ‚Äî SALMA (voyage)
Destination r√™v√©e: Japon
Nombre = lettres

Mot de passe probable ?`,
      hint:`japon = 5`,
      answer:`japon_5!`
    },
    { prompt:
`Q15 ‚Äî Devinette
Je suis cass√© sans √™tre tenu.

Mot = r√©ponse, Nombre = lettres`,
      hint:`on le garde`,
      answer:`secret_6!`
    },
    { prompt:
`Q16 ‚Äî OMAR (tests)
Omar met souvent ‚Äúadmin‚Äù quand il teste.
Nombre = 1.

Mot de passe probable ?`,
      hint:`admin + 1`,
      answer:`admin_1!`
    },
    { prompt:
`Q17 ‚Äî Devinette (tech)
Je n‚Äôai pas de vie, mais je peux mourir.
On me recharge.

Mot = r√©ponse, Nombre = lettres`,
      hint:`t√©l√©phone`,
      answer:`batterie_8!`
    },
    { prompt:
`Q18 ‚Äî Bio (food)
Nadia adore les tacos.
Elle met ‚Äútacos‚Äù + 2 (elle en prend 2 üòÑ).

Mot de passe ?`,
      hint:`tacos + 2`,
      answer:`tacos_2!`
    },
    { prompt:
`Q19 ‚Äî Devinette
Je suis plein de trous,
mais je retiens l‚Äôeau.

Mot = r√©ponse, Nombre = lettres`,
      hint:`cuisine`,
      answer:`eponge_6!`
    },
    { prompt:
`Q20 ‚Äî Finale (phrase)
Phrase pr√©f√©r√©e: "Never give up"
Mot = dernier mot, Nombre = lettres`,
      hint:`dernier mot = up`,
      answer:`up_2!`
    }
  ];

  // =========================
  // UI refs
  // =========================
  const qBadge = document.getElementById("qBadge");
  const timerBadge = document.getElementById("timerBadge");
  const promptEl = document.getElementById("prompt");
  const pwEl = document.getElementById("pw");
  const btnEl = document.getElementById("btn");
  const skipBtnEl = document.getElementById("skipBtn");
  const msgEl = document.getElementById("msg");
  const hintBox = document.getElementById("hintBox");
  const hintText = document.getElementById("hintText");
  const barEl = document.getElementById("bar");
  const winCard = document.getElementById("winCard");
  const gameCard = document.getElementById("gameCard");
  const winCodeEl = document.getElementById("winCode");

  function pad(n){ return String(n).padStart(2,"0"); }
  function setBad(t){ msgEl.className="badge bad"; msgEl.textContent=t; }
  function setInfo(t){ msgEl.className="badge muted"; msgEl.textContent=t; }

  function formatMMSS(ms){
    const s = Math.max(0, Math.ceil(ms/1000));
    const mm = Math.floor(s/60);
    const ss = s%60;
    return `${pad(mm)}:${pad(ss)}`;
  }

  // =========================
  // Game state + robust timers
  // =========================
  let qIndex = 0;
  let qStart = 0;
  let hintShown = false;
  let hintTimeout = null;
  let skipTimeout = null;

  const WIN_KEY = "guess_pw_win_code_v5";

  // If already won on this device, show WIN screen
  const alreadyWon = localStorage.getItem(WIN_KEY);
  if (alreadyWon) {
    gameCard.style.display = "none";
    winCard.style.display = "block";
    winCodeEl.textContent = alreadyWon;
  }

  function clearTimers(){
    if (hintTimeout) { clearTimeout(hintTimeout); hintTimeout = null; }
    if (skipTimeout) { clearTimeout(skipTimeout); skipTimeout = null; }
  }

  function showHintOnce(){
    if (hintShown) return;
    hintShown = true;
    hintText.textContent = QUESTIONS[qIndex].hint;
    hintBox.style.display = "inline-block";
  }

  function scheduleTimers(){
    clearTimers();
    hintTimeout = setTimeout(() => {
      if (!localStorage.getItem(WIN_KEY)) showHintOnce();
    }, HINT_AFTER_MS);

    skipTimeout = setTimeout(() => {
      if (!localStorage.getItem(WIN_KEY)) nextQuestion();
    }, AUTO_SKIP_MS);
  }

  function loadQuestion(i){
    qIndex = i;
    const q = QUESTIONS[qIndex];
    promptEl.textContent = q.prompt;
    qBadge.textContent = `Question ${qIndex+1}/20`;
    pwEl.value = "";
    pwEl.focus();

    hintShown = false;
    hintBox.style.display = "none";
    setInfo("Essais illimit√©s. Indice √† 40s.");

    qStart = Date.now();
    scheduleTimers();
  }

  function nextQuestion(){
    clearTimers();
    if (qIndex >= QUESTIONS.length - 1) {
      setInfo("Fin des 20 questions.");
      btnEl.disabled = true;
      skipBtnEl.disabled = true;
      return;
    }
    loadQuestion(qIndex + 1);
  }

  function generateWinCode(){
    const now = new Date();
    const t = `${pad(now.getHours())}${pad(now.getMinutes())}${pad(now.getSeconds())}`;
    const rand = Math.random().toString(36).slice(2,6).toUpperCase();
    return `Q${qIndex+1}-${t}-${rand}`;
  }

  function checkPassword(){
    const entered = (pwEl.value || "").trim();
    if (!entered) return setBad("Entre une tentative üôÇ");

    const ans = QUESTIONS[qIndex].answer;
    if (entered === ans) {
      const code = generateWinCode();
      localStorage.setItem(WIN_KEY, code);

      clearTimers();
      gameCard.style.display = "none";
      winCard.style.display = "block";
      winCodeEl.textContent = code;
      return;
    }
    setBad("‚ùå Pas encore. Essaie une autre combinaison !");
    pwEl.select();
  }

  btnEl.addEventListener("click", checkPassword);
  pwEl.addEventListener("keydown", (e)=>{ if(e.key==="Enter") checkPassword(); });
  skipBtnEl.addEventListener("click", nextQuestion);

  // Display loop (visual only, actions handled by timeouts)
  function tick(){
    if (localStorage.getItem(WIN_KEY)) return;

    const elapsed = Date.now() - qStart;
    const remaining = Math.max(0, AUTO_SKIP_MS - elapsed);

    timerBadge.textContent = `‚è≥ ${formatMMSS(remaining)}`;
    barEl.style.width = Math.min(100, (elapsed / AUTO_SKIP_MS) * 100) + "%";

    // Visual catch-up
    if (!hintShown && elapsed >= HINT_AFTER_MS) showHintOnce();
    if (elapsed >= AUTO_SKIP_MS) nextQuestion(); // fallback safety
  }
  setInterval(tick, 200);

  // Catch-up when returning to tab/app
  document.addEventListener("visibilitychange", () => {
    if (document.visibilityState === "visible" && !localStorage.getItem(WIN_KEY)) {
      const elapsed = Date.now() - qStart;
      if (elapsed >= AUTO_SKIP_MS) nextQuestion();
      else if (elapsed >= HINT_AFTER_MS && !hintShown) showHintOnce();
    }
  });

  // Start
  if (!alreadyWon) loadQuestion(0);
</script>
</body>
</html>
